var translations = {
	"en": {
		"LANGUAGE": "Language",
		"HOME": "Home",
		"CONTAINERS_LIST": "Containers List",
		"INVOICES": "Invoices",
		"CONTACT_MANAGER": "Contact Manager",
		"APP_FEEDBACK": "App Feedback",
		"SETTINGS": "Settings",
		"LOG_OUT": "Log out",
		"LOGIN": "Login",
		"USERNAME": "Username",
		"PASSWORD": "Password",
		"CONTACT_SALES_MANAGER": "Contact sales manager",
		"CONTACT_CHIEF_OF_SALES": "Contact chief of sales",
		"SEND_EMAIL": "Send email",
		"SEND": "Send",
		"SEND_TO": "To",
		"EMAIL_MESSAGE": "Message",
		"SUBJECT": "Subject",
		"PULL_TO_REFRESH": "Pull to refresh...",
		"SEARCH": "Search",
		"SORT": "Sort",
		"ETA_MAX_TO_MIN": "ETA max to min",
		"ETA_MIN_TO_MAX": "ETA min to max",
		"ETD_MAX_TO_MIN": "ETD max to min",
		"ETD_MIN_TO_MAX": "ETD min to max",
		"CONTAINERS_DETAILS": "Containers details",
		"ORDER_NO": "Order no",
		"CONT_NO": "Cont no",
		"CONT_TYPE": "Cont type",
		"ETD": "ETD",
		"ETA": "ETA",
		"POL": "Port of loading",
		"CARGO": "Cargo",
		"BRUTTO": "Brutto",
		"DOCUMENTS": "Documents",
		"DRIVER_INFO": "Driver info",
		"DRIVER": "Driver",
		"AUTO_NO": "Auto No",
		"PHONE": "Phone",
		"MARINE_CONTAINER_TRANSPORTATION": "Marine container transportation",
		"AUTO_TRANSPORT": "Auto transport",
		"LCL_CARGO": "LCL cargo",
		"RAIL_TRANSPORTATION": "Rail transportation",
		"DOCUMENTS_LIST": "Documents list",
		"ADD_NEW_REVIEW": "Add new review",
		"ARCHIVE": "Archive",
		"CLIENTS_LIST": "Clients list",
		"PUSH_MESSAGES": "Notifications",
		"TIME_OF_SENDING": "Time of sending",
		"COPIED_SUCCESSFULLY": "copied successfully",
		"FILTER": "Filter",
		"NO_RESULTS": "No Results",
		"COPY": "copy",
		"PLAN_FOR_TODAY": "Plan for today",
		"HBL": "HBL",
		"MBL": "MBL",
		"AIR_TRANSPORT": "Air",
		"MSG_SEND": "Message sent",
		"MARINE_CONTAINER_TRANSPORTATION_DESCR": "The most popular form of international transport. Thousands of importers, exporters prefer this way of transporting cargo. Existing methods of organization allow traffic to transport both large batches and single loads with maximum efficiency.",
		"AUTO_TRANSPORT_DESCR": "Transport - the fastest delivery method after the air. Therefore, it can be applied in many land supply chains, given that the cost of road transport is lower than that of air.",
		"LCL_CARGO_DESCR": "LCL – one of the most popular shipment types which enables transportation of small freights owned by different customers in one vehicle; note that each customer pays only for his cargo placement",
		"RAIL_TRANSPORTATION_DESCR": "International railway transportations implement delivery whether within required tonnage containers (from 3 to 40 tones) or by railcars of any kind. We have sufficient experience and competence for optimal arrangement of delivery and rate of charge for activated rolling-stock.",
		"AIR_TRANSPORT_DESCR": "The main advantage of the international air cargo transportation, of course, is speed. This is the most efficient way to delivery. And despite the relatively high price of this type of transportation is in demand when it is necessary to deliver the goods quickly, reliably and at a long distance."
	},
	"ru": {
		"LANGUAGE": "Язык",
		"HOME": "Главная",
		"CONTAINERS_LIST": "Список контейнеров",
		"INVOICES": "Счета",
		"CONTACT_MANAGER": "Связь с менеджером",
		"APP_FEEDBACK": "Отзывы о приложении",
		"SETTINGS": "Настройки",
		"LOG_OUT": "Выйти",
		"LOGIN": "Вход",
		"USERNAME": "Логин",
		"PASSWORD": "Пароль",
		"CONTACT_SALES_MANAGER": "Связаться с менеджером",
		"CONTACT_CHIEF_OF_SALES": "Связаться с начальнико менеджера",
		"SEND_EMAIL": "Отправить email",
		"SEND": "Отправить",
		"SEND_TO": "Кому",
		"EMAIL_MESSAGE": "Текст",
		"SUBJECT": "Тема",
		"PULL_TO_REFRESH": "Потяните, чтобы обновить...",
		"SEARCH": "Поиск",
		"SORT": "Сортировка",
		"ETA_MAX_TO_MIN": "ETA по убыванию",
		"ETA_MIN_TO_MAX": "ETA по возрастанию",
		"ETD_MAX_TO_MIN": "ETD по убыванию",
		"ETD_MIN_TO_MAX": "ETD по возрастанию",
		"CONTAINERS_DETAILS": "Детальная информация",
		"ORDER_NO": "Номер заказа",
		"CONT_NO": "Номер контейнера",
		"CONT_TYPE": "Тип контейнера",
		"ETD": "ETD",
		"ETA": "ETA",
		"POL": "Порт загрузки",
		"POD": "Порт выгрузки",
		"CARGO": "Груз",
		"BRUTTO": "Вес",
		"DOCUMENTS": "Документы",
		"DRIVER_INFO": "Информация о водителе",
		"DRIVER": "Водитель",
		"AUTO_NO": "Номер авто",
		"PHONE": "Телефон",
		"MARINE_CONTAINER_TRANSPORTATION": "Морские контейнерные перевозки",
		"AUTO_TRANSPORT": "Авто перевозки",
		"LCL_CARGO": "LCL грузы",
		"RAIL_TRANSPORTATION": "Ж/Д перевозки",
		"DOCUMENTS_LIST": "Список документов",
		"ADD_NEW_REVIEW": "Добавить отзыв",
		"ARCHIVE": "Архив",
		"CLIENTS_LIST": "Список клиентов",
		"PUSH_MESSAGES": "Уведомления",
		"TIME_OF_SENDING": "Время отправки",
		"COPIED_SUCCESSFULLY": "скопирована",
		"FILTER": "Фильтр",
		"NO_RESULTS": "Нет результатов",
		"COPY": "скопировать",
		"PLAN_FOR_TODAY": "План на сегодня",
		"HBL": "HBL",
		"MBL": "MBL",
		"AIR_TRANSPORT": "Авиаперевозки",
		"MSG_SEND": "Сообщение отправлено",
		"MARINE_CONTAINER_TRANSPORTATION_DESCR": "Самый популярный вид международных перевозок. Тысячи импортеров-экспортеров предпочитают именно этот способ транспортировки груза. Существующие сегодня способы организации перевозок дают возможность транспортировать как крупные партии, так и одиночные грузы с максимальной эффективностью.",
		"AUTO_TRANSPORT_DESCR": "Автотранспорт — самый быстрый способ доставки после воздушного. Следовательно, его можно применить во многих сухопутных логистических цепочках, учитывая, что стоимость автоперевозок ниже, чем у авиационных.",
		"LCL_CARGO_DESCR": "Перевозка сборных грузов (LCL) – один из наиболее востребованных видов перевозок, который позволяет перевозить малогабаритные партии грузов от разных клиентов в одном транспортном средстве, оплачивая, при этом, только занимаемое их грузом место.",
		"RAIL_TRANSPORTATION_DESCR": "Железнодорожные перевозки грузов являются самыми эффективными в соотношении цена/качество по сравнению с морскими, авто и авиа перевозками.",
		"AIR_TRANSPORT_DESCR": "Главным достоинством грузовых международных авиа перевозок, безусловно, является скорость. Это наиболее оперативный способ доставки. И не смотря на достаточно высокие цены этот вид перевозок пользуется спросом когда необходимо доставить груз быстро , надежно и на дальнее расстояние."
	},
	"ua": {
		"LANGUAGE": "Мова",
		"HOME": "Головна",
		"CONTAINERS_LIST": "Список контейнерів",
		"INVOICES": "Рахунки",
		"CONTACT_MANAGER": "Зв'язок з менеджером",
		"APP_FEEDBACK": "Відгуки про програму",
		"SETTINGS": "Налаштування",
		"LOG_OUT": "Вийти",
		"LOGIN": "Вхід",
		"USERNAME": "Логін",
		"PASSWORD": "Пароль",
		"CONTACT_SALES_MANAGER": "Зв'язатися з менеджером",
		"CONTACT_CHIEF_OF_SALES": "Зв'язатися з начальником менеджера",
		"SEND_EMAIL": "Відправити email",
		"SEND": "Відправити",
		"SEND_TO": "Кому",
		"EMAIL_MESSAGE": "Текст",
		"SUBJECT": "Тема",
		"PULL_TO_REFRESH": "Потягніть, щоб оновити...",
		"SEARCH": "Пошук",
		"SORT": "Сортування",
		"ETA_MAX_TO_MIN": "ETA за зменшенням",
		"ETA_MIN_TO_MAX": "ETA за зростанням",
		"ETD_MAX_TO_MIN": "ETD за зменшенням",
		"ETD_MIN_TO_MAX": "ETD за зростанням",
		"CONTAINERS_DETAILS": "Детальна інформація",
		"ORDER_NO": "Номер замовлення",
		"CONT_NO": "Номер контейнера",
		"CONT_TYPE": "Тип контейнера",
		"ETD": "ETD",
		"ETA": "ETA",
		"POL": "Порт завантаження",
		"POD": "Порт вивантаження",
		"CARGO": "Вантаж",
		"BRUTTO": "Вага",
		"DOCUMENTS": "Документи",
		"DRIVER_INFO": "Інформація про водія",
		"DRIVER": "Водій",
		"AUTO_NO": "Номер авто",
		"PHONE": "Телефон",
		"MARINE_CONTAINER_TRANSPORTATION": "Морські контейнерні перевезення",
		"AUTO_TRANSPORT": "Автоперевезення",
		"LCL_CARGO": "LCL вантажі",
		"RAIL_TRANSPORTATION": "Ж/Д перевезення",
		"DOCUMENTS_LIST": "Перелік документів",
		"ADD_NEW_REVIEW": "Додати відгук",
		"ARCHIVE": "Архів",
		"CLIENTS_LIST": "Список клієнтів",
		"PUSH_MESSAGES": "Повідомлення",
		"TIME_OF_SENDING": "Час відправлення",
		"COPIED_SUCCESSFULLY": "скопійована",
		"FILTER": "Фільтр",
		"NO_RESULTS": "Немає результатів",
		"COPY": "скопіювати",
		"PLAN_FOR_TODAY": "План на сьогодні",
		"HBL": "HBL",
		"MBL": "MBL",
		"AIR_TRANSPORT": "Авіаперевезення",
		"MSG_SEND": "Повідомлення відправлено",
		"MARINE_CONTAINER_TRANSPORTATION_DESCR": "Найпопулярніший вид міжнародних перевезень. Тисячі імпортерів-експортерів віддають перевагу саме цей спосіб транспортування вантажу. Існуючі сьогодні способи організації перевезень дають можливість транспортувати як великі партії, так і одиночні вантажі з максимальною ефективністю.",
		"AUTO_TRANSPORT_DESCR": "Автотранспорт - найшвидший спосіб доставки після повітряного. Отже, його можна застосувати в багатьох сухопутних логістичних ланцюжках, враховуючи, що вартість автоперевезень нижче, ніж у авіаційних.",
		"LCL_CARGO_DESCR": "Перевезення збірних вантажів (LCL) – один з найбільш затребуваних видів перевезень, який дозволяє перевозити малогабаритні партії вантажів від різних клієнтів в одному транспортному засобі, оплачуючи, при цьому, тільки займане їх вантажем місце.",
		"RAIL_TRANSPORTATION_DESCR": "Міжнародні залізничні вантажоперевезення організовуються як контейнерами необхідного тоннажу (від 3 до 40 т), так і вагонами всіх видів. Ми володіємо необхідним досвідом і кваліфікацією для розробки оптимальних схем перевезення і тарифів задіяння рухомого складу.",
		"AIR_TRANSPORT_DESCR": "Головною перевагою вантажних міжнародних авіа перевезень, безумовно, є швидкість. Це найбільш оперативний спосіб доставки. І не дивлячись на досить високі ціни цей вид перевезень користується попитом коли необхідно доставити вантаж швидко, надійно і на далеку відстань."
	}
}

var server_url = "http://client.uni-laman.com/android/ver_4/index.php";

var app_state = "";

angular.module('app')

.constant('$ionicLoadingConfig', {
  template: '<div class="loader"><svg class="circular"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg></div>'
  //templateUrl: '/img/loader.gif'
})

.config(function ($httpProvider, $translateProvider, $ionicConfigProvider) {

	for(lang in translations){
		$translateProvider.translations(lang, translations[lang]);
	}
	$translateProvider.preferredLanguage('en');

	if ( ionic.Platform.isIOS() ) {
		$ionicConfigProvider.views.swipeBackEnabled(false);
	}

	$httpProvider.useApplyAsync(true);

	$httpProvider.interceptors.push(function($rootScope, $cordovaNetwork, $location) {
		return {
			request: function(config) {
				$rootScope.$broadcast('loading:show')
				return config
			},
			response: function(response) {
				$rootScope.$broadcast('loading:hide');
				return response
			},
			requestError: function(config) {

			},
			responseError: function(response) {
				console.log(response.data);
				if ( (response.data.status == 401 || response.data.status == 500) && response.data.code != 1 && response.data.code != 2 ) {
					window.localStorage.removeItem("session_id");
			    window.localStorage.removeItem("mode");
					$location.path('/login');
					window.location.reload(true);
				}
				$rootScope.$broadcast('loading:hide');
				if ( ! $cordovaNetwork.isOnline() ) {
					$rootScope.showToast('The internet is disconnected on your device!');
				} else {
					$rootScope.showToast(response.data.message);
				}
			}
		}
	});
})
.run(function($ionicPlatform, $rootScope, $ionicLoading, $ionicPopup, $cordovaNetwork, $cordovaToast, $translate, $http, $location) {
	$translate.use(localStorage['lang']);

	$rootScope.$on('loading:show', function() {
		$ionicLoading.show();
	});

	$rootScope.$on('loading:hide', function() {
	    $ionicLoading.hide();
	    $rootScope.$broadcast('scroll.refreshComplete');
	    $rootScope.$broadcast('scroll.infiniteScrollComplete');
	});

	$rootScope.showToast = function(err_msg) {
	  $cordovaToast
	    .show(err_msg, 'long', 'bottom')
	    .then(function(success) {
	      // success
	    }, function (error) {
	      // error
	    });
	};

	// listen for Online event
    $rootScope.$on('$cordovaNetwork:online', function(event, networkState) {
    	$rootScope.showToast('Network:online');
    });

    // listen for Offline event
    $rootScope.$on('$cordovaNetwork:offline', function(event, networkState) {
    	$rootScope.showToast('Network:offline');
    });

	$ionicPlatform.ready(function() {
		if(window.Connection) {
            if( navigator.connection.type == Connection.NONE ) {
                $ionicPopup.confirm({
                    title: "Internet Disconnected",
                    content: "The internet is disconnected on your device."
                })
                .then(function(result) {
                    if(!result) {
                        ionic.Platform.exitApp();
                    }
                });
            }
        }
        document.addEventListener("deviceReady", function () {
					document.addEventListener("pause", function () {
          	console.log("on pause !!!!!!!");
						app_state = "pause";
					}, false);
	        document.addEventListener("resume", function () {
          	console.log("on resume !!!!!!!");
						app_state = "resume";
					}, false);
				}, false);

		var push = PushNotification.init({
            "android": {
              "senderID": "159592749979",
							"forceShow" : "true"
            },
            "ios": {
							"senderID": "159592749979",
							"alert": "true",
							"badge": "true",
							"sound": "true",
							"gcmSandbox": "false"
						},
            "windows": {}
        });

        push.on('registration', function(data) {
            console.log("registration event");
            localStorage['device_token'] = data.registrationId;
            console.log(JSON.stringify(data));
        });

        push.on('notification', function(data) {
					//cordova.plugins.notification.badge.set(1);
					//cordova.plugins.notification.badge.increase();

					console.log(app_state);
        	console.log("notification event");
					console.log(JSON.stringify(data));
					$location.path('/app/push-messages');

          push.finish(function () {
              console.log('finish successfully called');
          });
        });

        push.on('error', function(e) {
            console.log("push error");
        });

	});
});
